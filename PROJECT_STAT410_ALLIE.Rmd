---
title: "STAT 410 Project"
author: "Allie Shelton"
date: "2024-05-04"
output: html_document
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(tidyr)
library(factoextra)
```


<span style="color:blue">Hierarchical clustering: </span>
 

We will take a look at the most common type of hierarchical clustering called agglomerative clustering. 

Agglomerative Clustering is used to group objects into clusters based on their similarity. 

The algorithm starts by treating each object as a singleton cluster. Next, pairs of clusters are successively merged until all clusters have been merged into one big cluster containing all objects. The result is a tree-based representation of the objects, named dendrogram. 

Agglomerative clustering works in a “bottom-up” manner. That is, each object is initially considered as a single-element cluster (leaf). At each step of the algorithm,the two clusters that are the most similar are combined into a new bigger cluster (nodes). This procedure is iterated until all points are member of just one single big cluster (root)  

(Kassambara, 2017)

We will look at the <span style="color:blue">USArrests </span> data set to explore agglomerative clustering. 

<span style="color:blue">USArrests </span> has 50 rows representing each US state and 4 columns representing the murder, assault, urban pop, and rape rates per 100,000

```{r, echo=FALSE}

data("USArrests")

head(USArrests)

```

We need to scale the data. We scale the data because this way all the data points will be on the same "scale" for example two different data points could be measured in kg and lbs, we want them on the same scale. 

```{r}

arrests <- scale(USArrests)

```

 
To see which clustered should be combined/divided we need a method for measuring the similarity between the objects.

We will use the dist function which computes the Euclidean distance (distance between two objects). The smaller the distance the more similar they are.

Euclidean distance formula: 

$$
\text{Euclidean Distance} = \sqrt{\sum_{i=1}^{n} (x_i - y_i)^2}
$$

```{r}

## use the dist function
distance <- dist(arrests, method = "euclidean")

## create a matrix of the dist function
distance_matrix <- as.matrix(distance)

##head(distance_matrix)

```

The linkage function takes the distance information, returned by the function dist(),and groups pairs of objects into clusters based on their similarity. Then, these newly formed clusters are linked to each other to create bigger clusters. This process is iterated until all the objects in the original data set are linked together in a hierarchical tree. (Kassambara, 2017)

Ward’s minimum variance method: This method minimizes the total within-cluster variance. At each step the pair of clusters with minimum between-cluster distance are merged.


```{r}
## minimizing total within-cluster-variance

H_tree <- hclust(d = distance, method = "ward.D2")

```

The function fviz_dend() from the factoexrta package will create a graphical representation of our hierarchical tree called a dendrogram. 
```{r}

## create a dendrogram

fviz_dend(H_tree, cex = 0.5)


```

-In the above dendrogram, each object that is similar is connected in a branch, as we go up the tree similar objects are combined into the branch. 

-As the height of the tree increases, the less similar the objects are.

-The height is known as the cophenetic distance between the two objects. The cophenetic distance reflects how similar or dissimilar two clusters are before they are merged. The higher the height, the greater the cophenetic distance, and consequently, the lower the similarity between the merged clusters. (Kassambara, 2017)

The formula for calculating the cophenetic distance between two observations \(i\) and \(j\) in hierarchical clustering is:

\[
\text{Cophenetic Distance}_{ij} = \text{Height of the Dendrogram at Which Clusters \(i\) and \(j\) Merge}
\]




<span style="color:blue"> HOW DO WE KNOW THE CLUSTER TREE IS ACCURATE? </span>


 One way to measure how well the cluster tree generated by the hclust() function reflects your data is to compute the correlation between the cophenetic distances and the original distance data generated by the dist() function. 

If the clustering is valid, the linking of objects in the cluster tree should have a strong correlation with the distances between objects in the original distance matrix. We are typically looking for a correlation above 0.75.

```{r}

## compute cophentic distance
cophenetic_dist <- cophenetic(H_tree)

## compute correlation between cophentic and original distance
cor(distance,cophenetic_dist)

```


 Because the correlation between the cophentic and original distance is only 0.697 (we are looking for 0.75 and above) we will execute the hclust() function again using the average linkage method. The average linkage method is a method used in hierarchical clustering to determine the distance between two clusters.



Average linkage method: The distance between two clusters is defined as the average distance between the elements in cluster 1 and the elements in cluster 2.

```{r}

H_tree2 <- hclust(distance, method = "average")


cor(distance, cophenetic(H_tree2))

```

The correlation coefficient of 0.718 shows us that using the average linkage method creates a tree that represents our original data a bit better. Even though the correlation is slightly better, we will continue the rest of this example with the Ward.D2 method. The reason we will continue with this method is because Ward's method is generally preferred over the average linkage method. 



<span style="color:blue">CUTTING THE DENDROGRAM INTO DIFFERENT GROUPS:  </span>


Hierarchical clustering does not tell us how many clusters there are or where to cut the dendrogram off to form our clusters. We can look at the dendrogram to see where the best cut off seems to be. If we look at the dendrogram above, we can see that 4 looks like the optimal number.  

The function cutree() can be used to cut a tree into several groups, either by specifying the number of groups or the cut height. 

```{r, echo=FALSE}
## cut the tree into 4 groups
grp <- cutree(H_tree, k=4)

head(grp)

## number of members in each group
table(grp)

## get the names of the members in cluster 1
rownames(arrests)[grp==1]

cat("\n")

## get the names of the members in cluster 2
rownames(arrests)[grp==2]

cat("\n")

## get the names of the members in cluster 3
rownames(arrests)[grp==3]

cat("\n")

## get the names of the members in cluster 4
rownames(arrests)[grp==4]

```

```{r}
# Cut in 4 groups and color by groups
fviz_dend(H_tree, k = 4, # Cut in four groups
cex = 0.5, # label size
k_colors = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE # Add rectangle around groups
)

```

Based on the dendrogram above, we can clearly see which objects are in the same cluster by the colors. There is also a rectangular box around the clusters for more clarity. 

```{r}

## visualize as a scatter plot 
fviz_cluster(list(data = arrests, cluster = grp),
palette = c("#2E9FDF", "#00AFBB", "#E7B800", "#FC4E07"),
ellipse.type = "convex", # Concentration ellipse
repel = TRUE, # Avoid label overplotting (slow)
show.clust.cent = FALSE, ggtheme = theme_minimal())


```


Based on the above scatter plot of the clusters, we can see what states are grouped together based on the murder, assault, urban pop, and rape rates. Just by looking at the scatter plot we can notice that cluster 3 contains 7 states, all of which are in the south. If we had more information we could examine these clusters in greater detail. We will do that in the following section with my data.


<span style="color:blue">Let's use these new techniques to explore LA crime data.:</span>


<span style="color:red">Research Question : :</span>


How can we group the 21 geographical areas of LA when considering the top 5 crimes based on victim demographics such as age and gender, and crime count? Based off of these groupings, how do the victim demographics and crime count compare?

This is a very important topic as it gives us insights on crime patterns in LA. Understanding these crimes patterns is critical as it allows for police and government officials to create targeted strategies and plans to address and prevent crimes. Knowing the crime patterns will help keep residents of the city safe. Using cluster analysis for this research will give us the ability to uncover hidden relationships and patterns within the data, allowing for a deeper understanding of crime dynamics across different regions in LA.   


<span style="color:green">Data description:</span>

The data set we will be exploring contains crime data in Los Angeles from 2020 to present day. This data set is quite large as it has 932K rows and 28 columns. For the purpose of this research we will cut down the data to only contain 4 variables, namely: Area, Crm.Cd.Desc, Vict.Age, and Vict.sex. 

-Area represents one of the 21 LAPD police stations (referred to as geographical areas).

-Crm.Cd.Desc represents the type of crime provided

-Vict.Age refers to the victims age.

-Vict.sex refers to the victims sex. 


```{r}
#setwd("/Users/allieshelton/Downloads/")
LAcrime <- read.csv("Crime_Data_from_2020_to_Present_20240417.csv")

head(LAcrime)



```

```{r, echo=FALSE}

## Calculate the total number of unique crimes in the data set
unique_crimeCount <- LAcrime|>
  distinct(Crm.Cd.Desc)|>
  nrow()

unique_crimeCount

```
There are 139 unique crimes. Using all 139 crimes would be a bit messy for clustering. We will take the five most frequent occurring crimes to investigate. 


We will now identify the top 5 most common crimes:
```{r, echo=FALSE}

##crime count
crime_Freq <- LAcrime|>
  group_by(Crm.Cd.Desc) |>
  summarise(Crime_Count = n()) |>
  ungroup()



# Rank crimes
crime_ranked <- crime_Freq |>
  arrange(desc(Crime_Count))

head(crime_ranked,5)



```
The top five most occuring crimes include, vehicle-stolen, battery-simple assault, theft of identity, burglary from vehicle, and burglary.


Now we will remove all crimes, other than the ones of interest:

```{r, echo=FALSE}

##removing all crimes other than the top 5 we are interested in

crimes_of_interest <- c("VEHICLE - STOLEN", "BATTERY - SIMPLE ASSAULT", "THEFT OF IDENTITY", "BURGLARY FROM VEHICLE", "BURGLARY")

LAcrime <- LAcrime |>
  filter(Crm.Cd.Desc %in% crimes_of_interest)

head(LAcrime)



```



We will now remove any variables that are not useful in answering our research question. We will also remove any rows that have an unknown victim age as well as a missing value for victim gender

```{r, echo=FALSE}

## columns to remove

columns_to_remove <- c("DR_NO", "Date.Rptd", "DATE.OCC", "Status", "Weapon.Used.Cd", "Cross.Street", "LOCATION", "Crm.Cd.2", "Crm.Cd.3", "Crm.Cd.4", "Rpt.Dist.No","Crm.Cd.1", "Mocodes", "AREA.NAME", "TIME.OCC", "Part.1.2","Crm.Cd", "Vict.Descent","Premis.Cd", "Premis.Desc", "Weapon.Used.Cd", "Weapon.Desc", "Status.Desc", "LAT", "LON"  )



## keeping all of the columns other than the ones specified above

LAcrime2 <- LAcrime[, !names(LAcrime) %in% columns_to_remove]

## remove all rows where victim age is unknown (0) & only keeping the rows where victim sex is known
LAcrime2 <- LAcrime2 |>
  filter(Vict.Age > 0)|>
  filter(Vict.Sex %in% c("M", "F"))

## making sure only males and females are in the data set
unique(LAcrime2$Vict.Sex)


head(LAcrime2)


```


<span style="color:red">Visualize Data : :</span>

```{r}

##visualizing crime counts and gender in all 21 areas

ggplot(LAcrime2, aes(x=Crm.Cd.Desc, fill=Vict.Sex))+
  geom_histogram(stat = "count")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  labs(title = "Histogram of Crime Counts", x="Crime Type")


```

From the histogram above we can see the counts of the 5 different crimes across all 21 geographical areas. We can clearly see that Battery-simple assault has the highest count followed by theft of identity, burglary from vehicle, burglary, and stolen vehicle. We can also see that the count for women victims is higher for each crime.



How do the counts of male and female victims compare?

```{r, echo=FALSE}

## visualizing gender distribution for all 21 geographical areas combined

##ggplot(LAcrime2, aes(x= Vict.Sex, fill=Vict.Sex))+
 ## geom_histogram(stat = "count")+
  ##labs(title = "Gender distribution", x="Victim Sex")

## seeing how many males/females
table(LAcrime2$Vict.Sex)

```

There are 116,095 male victims and 106,818 female victims in the data set. 


```{r, echo=FALSE}


## box plot of victims age for the 5 different crimes

ggplot(data = LAcrime2, aes(x = Crm.Cd.Desc, y = Vict.Age)) +
  geom_boxplot(fill = "pink", color = "black") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  labs(title = "Boxplot of Victim Ages by Crime Type",
       x = "Crime Type",
       y = "Victim Age")




```



From the above box plot we can see that the median age seems to be the highest for burglary and the lowest for burglary from vehicle. There do seem to be outliers for all of the crimes. We can also observe that the range for each crime is quite similar, except for the range of vehicle stolen, as it is a bit smaller than the others.

```{r, echo=FALSE}

## box plot of victims age for the 5 different crimes

ggplot(data = LAcrime2, aes(x = Vict.Sex, y = Vict.Age)) +
  geom_boxplot(fill = "lightblue", color = "black") +
  labs(title = "Boxplot of Victim Ages by gender",
       x = "Gender",
       y = "Victim Age")



```

From the above box we can see that the Median age for male victims seems to be slightly greater than the median age for female victims. The range for male and female victims seem to be about the same. Both male victim ages and female victim ages have several outliers towards the top. 



Now we will calcultate the crime count for each crime in each area.

```{r, echo=FALSE}
##crime count for each crime & area
count_data <- LAcrime2 |>
  group_by(AREA, Crm.Cd.Desc) |>
  summarize(Crime_Count = n()) |>
  ungroup()

head(count_data)

```

Now we will calculate the proportion of each crime within each area.
```{r, echo=FALSE}
## proportions of each crime within each area
prop_data <- LAcrime2 |>
  group_by(AREA) |>
  count(Crm.Cd.Desc, name = "Crime_Count") |>
  mutate(Proportion_crime = Crime_Count / sum(Crime_Count))  # Calculate the proportion of each crime type within each geographic area
  
# Convert proportions to decimal format
prop_data$Proportion_crime <- sprintf("%.4f", prop_data$Proportion_crime)

head(prop_data)

```


Now we will calculate the victim demographics that we will be using for clustering. Because there were many outliers in the victim age box plot and we don't want that to affect our clustering algorithm, we will be using the median age for each. We are using the median because it is less influenced by outliers. On top of median victim age we will also calculate the proportion of male and female victims for each crime in each area. 
```{r, echo=FALSE}


victim_demographics <- LAcrime2 |>
  group_by(AREA, Crm.Cd.Desc) |>
  summarize(
    Median_victim_age = median(Vict.Age, na.rm = TRUE),
    Proportion_male_victims = sum(Vict.Sex == "M", na.rm = TRUE)/n(),
    Proportion_female_victims = sum(Vict.Sex == "F", na.rm = TRUE)/n(),
    ) 

head(victim_demographics)

```

Now that we have all of the variables we will be using to preform the clustering, we have to combine them all into a data frame, namely: <span style="color:red">LAcrime2_final.</span> 

To do this we are using a function called <span style="color:red">left_join().</span>

```{r,echo=FALSE}


# Join agg_data, prop_data, and victim_demographics with LAcrime2
##https://favtutor.com/blogs/left-join-r

LAcrime2_final <- left_join( count_data,prop_data, by = c("AREA", "Crm.Cd.Desc"))

# Left join the result with victim_demographics
LAcrime2_final <- left_join(LAcrime2_final, victim_demographics, by = c("AREA", "Crm.Cd.Desc"))

LAcrime2_final


## removing duplicate columns
LAcrime2_final$Mean_victim_age.y <- NULL
LAcrime2_final$Proportion_male_victims.y <- NULL
LAcrime2_final$Proportion_female_victims.y <- NULL
LAcrime2_final$Crime_Count.y <- NULL
head(LAcrime2_final)


```



Now that we have all of the data we are using in LAcrime2_final, we will transform this data from long to wide. Doing this will give us a data frame with 21 rows, each representing an area. We will call this data frame <span style="color:red">LAcrime2_wide.</span>

```{r,echo=FALSE}


# change the data from long to wide (this way we can have each row represent an area)
# https://tidyr.tidyverse.org/reference/pivot_wider.html

LAcrime2_wide <- LAcrime2_final |>
  pivot_wider(
    id_cols = AREA,
    names_from = Crm.Cd.Desc,
    values_from = c(Crime_Count.x, Proportion_crime, Median_victim_age, Proportion_male_victims, Proportion_female_victims),
    names_sep = "_"
  )


# Rename the columns (replace periods with underscores)
colnames(LAcrime2_wide) <- gsub("\\.", "_", colnames(LAcrime2_wide))



# View data
head(LAcrime2_wide)

```



```{r,echo=FALSE}

## taking out area

LAcrime2_wide <- dplyr::select(LAcrime2_wide,-AREA)

```



We will take all of the numeric values from <span style="color:red">LAcrime2_wide</span> so that we can <span style="color:blue">scale</span> the data in order to use it for clustering.

```{r,echo=FALSE}

## take all of the columns that are numeric from LAcrime2_wide
LAcrime2_wide <- LAcrime2_wide[sapply(LAcrime2_wide, is.numeric)]


##scale the data
scaled_data <- scale(LAcrime2_wide)

## change scaled_data row names to be area conctated with the corresponding area number
rownames(scaled_data) <- paste("Area", 1:nrow(scaled_data))

           
```


<span style="color:red">CLUSTERING : :</span>



Compute the (dis)similarity using the <span style="color:blue"> euclidean method.</span> :
```{r, echo=FALSE}


#compute the dissimilarity matrix
LA_distance2 <- dist(scaled_data, method = "euclidean")


```


Convert it into a matrix:

```{r,echo=FALSE}

## make LA_distance2 a matrix
as.matrix(LA_distance2)[1:6,1:6]

```


Create hierarchical tree using <span style="color:blue">Ward.D2 method:</span>
```{r, echo=FALSE}

## create hierarchical tree
## ward.D2 mimimizes the total within cluster variance

LA.hc <- hclust(d=LA_distance2, method="ward.D2")

```


create dengrogram using <span style="color:red">fviz_dend() </span> function from the <span style="color:red">factoextra </span> package.
```{r, echo=FALSE}

## creating the dendrogram

fviz_dend(LA.hc, cex = 0.5)

```
By just looking at the dendrogram we can see that the ideal number of clusters is 4. This is because as we get higher up the tree, the similarity between objects decreases.


Next we will compute the <span style="color:red">cophentic </span> distance and use that to find the correlation between the cophentic distance and the original distance:
```{r,echo=FALSE}


## computing cophentic distance (how similar/disimilar clusters are) (height of dendrogram)
LA_cop_dist <- cophenetic(LA.hc)



## correlation between cophenetic dist and original dist

cor(LA_distance2,LA_cop_dist)


```

Now we will see if using the <span style="color:red">average </span> method will give us a better correlation
```{r, echo=FALSE}

## using a different method (average) to see if the correlation is better
LA.hc2 <- hclust(LA_distance2, method="average")

cor(LA_distance2, cophenetic(LA.hc2))

```
using the average linkage method creates a tree that represents the original distance better. (correlation = 0.805), but when visualizing the dendrogram using the "average" linkage method, there were two clusters that only contained one area, so we will proceed with the method of Ward.D2

<span style="color:red">Note: </span> Ward.D2 linkage method is preferred over average linkage method


```{r}


## elbow method to see how many clusters we should take

fviz_nbclust(scaled_data, kmeans, method = "wss") ## method = wss (within cluster sum of squares(variability))


```


As you can see the plot shows a bend or "elbow" at 4, meaning our optimal number of clusters is 4. The bend indicates that the number of clusters beyond 4 have little to no value to us. Although there seems to be a bend at 6, when cutting the dendrogram into 6 clusters, there will be a cluster with one area which is not necessarily wanted for the purpose of our research. Also, our dendeogram validates our choice of 4 clusters.


```{r,echo=FALSE}

## cut the tree
group <- cutree(LA.hc, k=4)

```


Visualizing the dendrogram cut into 4 groups:
```{r, echo=FALSE}
## visualize dendrogram cut into 4 groups

fviz_dend(LA.hc, k = 4, # Cut in 4 groups
cex = 0.5, # label size
k_colors = c("blue", "green", "orange", "red" ),
color_labels_by_k = TRUE, # color labels by groups
rect = TRUE # Add rectangle around groups
)

```
Looking at the dendrogram above we can see the "areas" that will be grouped together. Each cluster is represented by a different color. There is also a box around each cluster for extra clarity.


Visualizing the clusters on a scatter plot:
```{r, echo=FALSE}
## visualizing the clusters on a scatterplot 

fviz_cluster(list(data = scaled_data, cluster = group),
palette = c("blue", "green", "orange", "red"),
ellipse.type = "convex", # Concentration ellipse
repel = TRUE, # Avoid label overplotting (slow)
show.clust.cent = FALSE, ggtheme = theme_minimal())



```


From the above scatter plot, we can see which areas are forming each cluster. It is also good to note that their is no overlap when looking at the clusters. This is what we want, if there were to be overlap there would be similarity between cluster which is not ideal. 



<span style="color:purple">How can we compare the areas within each cluster?</span>


<span style="color:blue">Cluster 1 contains: </span>

  Area 1, Area 2, Area 6, and Area 20. These areas are "Central", "Rampart", "Hollywood" , and "Olympic" respectively. 

- Area 1 borders area 2.

- Area 2 borders area 6 and 20

- Area 20 and Area 6 border each other. 


<span style="color:green">Cluster 2 contains: </span>

Area 3, Area 12, and Area 18 These areas are "South West", "77th", and "South East" respectively.

- Areas 3 and 12 border each other

- Areas 12 and 18 border each other

- They are all located in south LA. South LA has been known to face challenges with crime,poverty, and socioeconomic disparities. 


<span style="color:orange">Cluster 3 contains: </span>

Area 4, Area 5, Area 13, Area 16, Area 19. These areas are "Hollenbeck", "Harbor", "Newton", "Foothill", "Mission" respectively. 

- Area 19 and 16 are bordering regions and are located in the northern part of San Fernando Valley.

- Area 4 and 13 are bordering regions

- Area 5 does not border any of the other regions in cluster 3.


<span style="color:red">Cluster 4 contains: </span>

Area 7 , Area 8 , Area 9 , Area 10, Area 11,Area 14, Area 15, Area 17, and Area 21. These areas represent, "Wilshire","West LA", "Van Nuys", "West Valley", "North East" "Pacific", "North Hollywood", "Devon shire", and "Topanga". 

- Area 7 borders with some of Area 8

- Area 8 borders some of Area 14

- Area 8 borders Area 9 and Area 10

- Area 8 borders some of Area 15

- Area 9 borders Area 10 and Area 15

- Area 10, Area 17, and Area 21 all border each other.

- Some of Area 14 borders Area 8.

 

```{r, echo=FALSE}

##row_names <- paste("Area", 1:nrow(scaled_data))
##rownames(scaled_data) <- row_names


```


<span style="color:red">Examining the clusters:</span>

```{r, echo=FALSE}
## row names for cluster 1
#rownames(scaled_data)[group==1]

```


```{r, echo=FALSE}

## row names for cluster 2
##rownames(scaled_data)[group==2]

```


```{r, echo=FALSE}

## row names for cluster 3
##rownames(scaled_data)[group==3]

```

```{r, echo=FALSE}

## row names for cluster 4
##rownames(scaled_data)[group==4]

```

<span style="color:red">Cluster summary 1 - mean crime counts for each cluster:</span>

```{r, echo=FALSE}

## adding cluster column into data
LAcrime2_wide$cluster <- group

# Cluster summary 1 - mean crime counts for each cluster


cluster_summary1 <- LAcrime2_wide |>
  group_by(cluster) |>
  summarise(
    Mean_Crime_Count_BATTERY = mean(`Crime_Count_x_BATTERY - SIMPLE ASSAULT`, na.rm = TRUE),
    Mean_Crime_Count_BURGLARY = mean(`Crime_Count_x_BURGLARY`, na.rm = TRUE),
    Mean_Crime_Count_BURGLARY_FROM_VEHICLE = mean(`Crime_Count_x_BURGLARY FROM VEHICLE`, na.rm = TRUE),
    Mean_Crime_Count_THEFT_OF_IDENTITY = mean(`Crime_Count_x_THEFT OF IDENTITY`, na.rm = TRUE),
    Mean_Crime_Count_VEHICLE_STOLEN = mean(`Crime_Count_x_VEHICLE - STOLEN`, na.rm = TRUE)
  )



##printing cluster summary
cluster_summary1


```


- Looking at the mean crime counts for each crime within each cluster we can see some interesting things. 

- We can see that the most prevalent crime in all clusters is battery. The counts for other crimes in these clusters are not too far behind, with the exception of stolen vehicle. In each cluster the count for stolen vehicle is quite low.

- Overall, we can say that the distribution of crime counts is pretty consistent for all clusters.



<span style="color:red">cluster summary 2 - mean victim age for each crime (grouped by cluster):</span>

```{r, echo=FALSE}


##cluster summary 2 - mean victim age for each crime (grouped by cluster)
cluster_summary2 <- LAcrime2_wide|>
  group_by(cluster)|>
  summarise(
  mean_vict_age_BATTERY= mean(`Median_victim_age_BATTERY - SIMPLE ASSAULT`, na.rm = TRUE),
  mean_vict_age_BURGLARY = mean(Median_victim_age_BURGLARY, na.rm = TRUE),
  mean_vict_age_BURGULARY_FROM_VEHICLE = mean(`Median_victim_age_BURGLARY FROM VEHICLE`, na.rm = TRUE),
  mean_vict_age_THEFT_OF_IDENTITY = mean(`Median_victim_age_THEFT OF IDENTITY`, na.rm = TRUE),
  mean_vict_age_VEHICLE_STOLEN =mean(`Median_victim_age_VEHICLE - STOLEN`, na.rm = TRUE),

  )

##print 
cluster_summary2

```

From the summary of mean victim ages across the clusters we can note: 

- The mean victim age for battery seems to range from about 38-39.

- The mean victim age for burglary ranges from 41-46.

- The mean victim age for burglary from vehicle ranges from 33-37

- The mean victim age for theft of identity ranges from 35-41.

- The mean victim age for vehicle stolen ranges from 33-43.

- Overall, The ages all seem to range from mid 30's to early 40's. Why is this? Could it have to do with the age demographics or age distribution in LA as a whole? Is it because they are more likely to be involved in activities or situations that increase their risk of becoming a victim such as enjoying night life, social events, owning vehicles,ect. 


<span style="color:red">cluster summary 3 - calculating all of the mean victim proportions of male/female for battery-simple assault by cluster:</span>

```{r, echo=FALSE}

## calculating all of the mean victim proportions of male/female for battery-simple assault by cluster

cluster_summary3 <- LAcrime2_wide|>
  group_by(cluster)|>
  summarise(
    mean_prop_male_vict_BATTERY = mean(`Proportion_male_victims_BATTERY - SIMPLE ASSAULT`, na.rm=TRUE),
    mean_prop_female_vict_BATTERY =mean(`Proportion_female_victims_BATTERY - SIMPLE ASSAULT`, na.rm=TRUE),
  )

##print
cluster_summary3

```
- The proportion for male and female victims across all clusters seem to be about the same, with proportion of males being slightly greater, other than in <span style="color:green">Cluster 2 </span>. 

- <span style="color:green">Cluster 2 </span>  consists of "Area 3"  "Area 12" "Area 18". These areas are "South West", "77th", and "South East" respectively. These three areas are boarding neighborhoods.These neighborhoods are also all in South LA which has had problems with crime as well as differences in socioeconomic classes. Could the population of women in these areas be greater than the population of men? Further investigation into the demographics of these areas could reveal why the proportion on female victims is higher in this cluster / in the neighborhoods making up this cluster.    

- According to statista.com the number of male victims of violent crimes (from 2005-2022) are typically slightly higher. This data agrees with that, suggesting a consistency in gender dynamics when looking a violent crimes (battery) 

- Seeing that the proportion of male victims is higher than the proportion of female victims is an interesting observation because it is breaking stereotypes about victims, it is thought that typically males are perpetrators rather than victims, but this gives us a different insight.   

https://www.statista.com/statistics/423245/us-violent-crime-victims-by-gender/ 



<span style="color:red">cluster summary 4 -  calculating the mean victim proportions of male/female for burglary by cluster:</span>

```{r,echo=FALSE}

## calculating the mean victim proportions of male/female for burglary by cluster
cluster_summary4 <- LAcrime2_wide|>
  group_by(cluster)|>
  summarise(
    mean_prop_male_vict_BURGLARY = mean(Proportion_male_victims_BURGLARY, na.rm=TRUE),
    mean_prop_women_vict_BURGLARY = mean(Proportion_female_victims_BURGLARY, na.rm=TRUE),
  )


##print
cluster_summary4


```

The summary of mean male/female victim proportions of burglary reveals that men have a higher proportion than females in clusters 1,3, and 4. The proportion of women is slightly higher in <span style="color:green">Cluster 2 </span>. In <span style="color:orange">Cluster 3 </span> and <span style="color:red">Cluster 4 </span> we can see that there is quite a large difference in the proportion of male victims compared to women victims, there is nearly a 20% and 25% difference of proportions in <span style="color:orange">Cluster 3 </span> and <span style="color:red">Cluster 4 </span> respectively.



<span style="color:orange">Cluster 3 </span> contains, "Area 4" , "Area 5",  "Area 13","Area 16", and "Area 19". These areas represent, "Hollen Beck", "Harbor","Newton","Foot Hill",and "Mission" respectively.
  
  Note:

  -Areas 4 and 13 are bordering neighborhoods. 

  -Areas 16 and 19 are also bordering neighborhoods
  


<span style="color:red">Cluster 4 </span> contains, "Area 7" , "Area 8" , "Area 9" , "Area 10", "Area 11","Area 14", "Area 15", "Area 17", and "Area 21". These areas represent, "Wilshire","West LA", "Van Nuys", "West Valley", "North East" "Pacific", "North Hollywood", "Devon shire", and "Topanga". 

- It is interesting to note that areas 8, 9,10,15,17, and 21 are all bordering neighborhoods.
  
  
- Further investigation of these areas could give us valuable insights. Somethings I would be interested to further investigate include, socioeconomic classes, victim vulnerability (lifestyle, occupation, awareness). It would be interesting to see the time of day these crimes occurred, if they are mostly at night is there a heavy presence of night life in the areas?   



<span style="color:red">cluster summary 5 -  calculating all of the mean victim proportions of male/female for burglary from vehicle by cluster:</span>

```{r, echo=FALSE}

## calculating all of the mean victim proportions of male/female for burglary from vehicle by cluster

cluster_summary5 <- LAcrime2_wide|>
  group_by(cluster)|>
  summarise(
    mean_prop_male_vict_BURGLARY_FROM_VEHICLE = mean(`Proportion_male_victims_BURGLARY FROM VEHICLE`, na.rm=TRUE),
    mean_prop_female_vict_BURGLARY_FROM_VEHICLE = mean(`Proportion_female_victims_BURGLARY FROM VEHICLE`,na.rm=TRUE),
  )

##print
cluster_summary5


```

- The summary for mean proportion of male/female victims of burglary from vehicle reveals that for all clusters other than <span style="color:green">Cluster 2 </span>, the proportion of male victims is greater than the proportion of female victims.

- We can see that <span style="color:orange">Cluster 3 </span> has nearly a 20% difference in male victims vs female victims.

- Once again it would be interesting to further look into these crimes. Time of crime, male population vs female population, socioeconomic classes, education, etc could give us valuable information. 


<span style="color:red">cluster summary 6 -  calculating all of the mean victim proportions of male/female for theft of identity from vehicle by cluster:</span>
```{r,echo=FALSE}

## calculating all of the mean victim proportions of male/female for theft of identity by cluster

cluster_summary6 <- LAcrime2_wide|>
  group_by(cluster)|>
  summarise(
    mean_prop_male_vict_THEFT_OF_IDENTITY = mean(`Proportion_male_victims_THEFT OF IDENTITY`, na.rm=TRUE),
    mean_prop_female_vict_THEFT_OF_IDENTITY = mean(`Proportion_female_victims_THEFT OF IDENTITY`, na.rm=TRUE),
  ) 

##print
cluster_summary6

```


<span style="color:blue">The summary for mean proportion of male/female victims for theft of identity reveals different trends for each cluster. </span>

 

- <span style="color:blue">Cluster 1 </span> has slightly more female victims

- <span style="color:green">Cluster 2 </span> has notably more female victims

- <span style="color:orange">Cluster 3 </span> has notably more female victims

- <span style="color:red">Cluster 4 </span> has slightly more female victims

Let's examine cluster 2 & 3:

- <span style="color:green">Cluster 2 </span> consists of "Area 3" "Area 12" "Area 18". These areas are "South West", "77th", and "South East" respectively. All of these areas are in South LA, which is known for having challenges with crimes and socioeconomic disparities. 

- <span style="color:orange">Cluster 3 </span> consists of "Area 4" , "Area 5",  "Area 13","Area 16", and "Area 19". These areas represent, "Hollen Beck", "Harbor","Newton","Foot Hill",and "Mission" respectively.


- Unfortunately we don't know the demographics of these areas, but if we did we would be interested to see if there are more female residents than male residents. We could look into shopping aspects, are there many shops catered towards women that could be stealing their information/identity? We could even look into the demographics of these people. We could examine their education and socioeconomic class to see if they are more susceptible to identity theft. 



<span style="color:red">cluster summary 7 -  calculating all of the mean victim proportions of male/female for vehicle stolen by cluster:</span>

```{r,echo=FALSE}
## calculating all of the mean victim proportions of male/female for vehicle stolen by cluster

cluster_summary7 <- LAcrime2_wide|>
  group_by(cluster)|>
  summarise(
    mean_prop_male__vict_VEHICLE_STOLEN = mean(`Proportion_male_victims_VEHICLE - STOLEN`, na.rm=TRUE),
    mean_prop_female_vict_VEHICLE_STOLEN = mean(`Proportion_female_victims_VEHICLE - STOLEN`,na.rm=TRUE),
    
  )

## print
cluster_summary7


```



- <span style="color:blue">The summary for mean proportion of male/female victims for vehicle stolen </span> shows that there are more male victims than female victims for each cluster. It is interesting to note that clusters 3 and 4 have a big difference in proportions. 

- To further investigate this we could look into socioeconomic factors such as income and employment.Lower income areas could be more susceptible to this type of crime. We could look into population of these areas, are there more men? Maybe more men own vehicles making them more vulnerable to this crime. 






<span style="color:red">Conclusions and recommendations : :</span>



<span style="color:blue">Research Question : :</span>

How can we group the 21 geographical areas of LA when considering the top 5 crimes based on victim demographics such as age and gender, and crime count? Based off of these groupings, how do the victim demographics and crime count compare?

<span style="color:blue">Conclusion:</span>

After grouping the 21 different geographical areas of LA by considering the top 5 crimes and looking a age,gender, and crime count statistics we can note several important things. First we can note that the most prevalent crime across all clusters is battery. Other crimes counts did not fall far behind the count of battery, except the count of vehicle stolen crimes which had much lower crime counts in all clusters. From these observations we were able to conclude that the distribution of crime counts is consistent across all clusters. We next looked at the mean victim ages of all crimes across the 4 clusters. We noticed that the victim ages all seemed to range from mid 30's to early 40's. We then explored the proportion of male and female victims for each crime in each cluster. There were some very interesting observations when looking at this data. We noticed that typically men were victimized more than women. This observation is notable because it breaks stereotypes when it comes to crimes. Typically it is thought that women are more victimized than men, but our results have showed the opposite. Specifically, we saw that in area 3, men had a much higher proportion of being a victim of burglary, burglary from vehicle, and a stolen vehicle. We saw that in area 4, men had a much higher proportion of being a victim of burglary and a stolen vehicle. While overall men had higher rates of being a victim, there were some notable differences where females were more victimized than men. In area 2 and 3, women had a much higher proportion of being a victim of identity theft. Overall, our analysis reveals consistent trends in crime distribution across all clusters, with battery emerging as the most prevalent crime. While men generally experience higher victimization rates, our findings challenge conventional stereotypes by highlighting instances where women are disproportionately affected, particularly in certain crime categories and geographic areas. These new understandings highlight the importance of understanding crime statistics in LA in order to control and prevent crimes from happening. 

<span style="color:blue">Future Recommendations: </span>

For future analysis I would like to examine several factors about the victims.Specifically I would like to explore socioeconomic status. By socioeconomic status I mean, income, education, and occupation. Exploring variables like these and including it in our clustering algorithm would give us an deeper insights on victimization rates and would give us the ability to identify vulnerable groups of people. Gaining an understanding on how socioeconomic status relates to victimization would not only be interesting to see, it would enable change for communities by informing vulnerable groups. 

Another variable that would be interesting to look into is time. Incorporating time into the analysis would give us an idea of what crimes happen when and in what areas are crimes more likely to occur at a given time. Knowing this information would be great for police to know so they can patrol certain areas more heavily at certain times of day. Knowing the time distribution of crimes would also be beneficial to residents of high crime regions. Knowing that a certain crime is more likely to occur at a specific time in an area will bring awareness to potential victims and hopefully keep them safe.

On the flip side, I would be really interested in looking into perpetrator demographics. Some of these demographics include age, sex, education, income, occupation,etc. Looking into the perpetrator side of things would give great insights into the cause rather than the effect of crimes. Knowing this information could help prevent crimes from taking place.

For future analysis, we could compare crime dendrograms of different cities in California to see how they compare. By comparing these dendrograms we can identify similarities in crime trends. These similarities can reveal commonalities in crimes patterns and dynamics across cities in California. These comparisons can reveal geographical trends, geographical variations, and factors that influence crimes. Knowing how a whole state of cities compare can lead to solving crime issues and making the state safer as a whole. 

This is just a start, there are many other statistical analysis techniques that could be applied to my data to explore crime trends and patterns. All of these techniques would provide valuable insights of crime dynamics. By using these techniques and understanding the outcomes we can develop strategies for crime prevention as well as victim protection.  


Bibliography:

Ganguly, A. (2023, September 12). How to do left join in R?: 2 methods (with examples). FavTutor. https://favtutor.com/blogs/left-join-r 

Kassambara, A. (2017). Practical guide to cluster analysis in R: Unsupervised machine learning. STHDA. 

Korhonen, V. (2023, October 26). U.S. violent crime victims, by gender 2022. Statista. https://www.statista.com/statistics/423245/us-violent-crime-victims-by-gender/ 

Wickham, H. (n.d.). Pivot data from long to wide - pivot_wider. - pivot_wider • tidyr. https://tidyr.tidyverse.org/reference/pivot_wider.html 
